import{j as e}from"./ui-vendor-CCxVMQ9B.js";import{r as c,L as x}from"./react-vendor-CN1YoO9o.js";import{r as f,B as l,I as S,E as T,D as R,v as E,w as L,x as B,y as A,z as k}from"./index-DStP_-PY.js";import{C as z,b as _,a as H}from"./card-DDJFiqOK.js";import{B as F}from"./badge-B80lkMBr.js";import{T as P,a as $,b as g,c as t,d as q,e as i}from"./table-CZG2d7nx.js";import{P as I}from"./plus-B7lLGJlf.js";import{S as G}from"./search-DyISHBFt.js";import{S as M}from"./square-pen--POmUCjf.js";import{T as O}from"./trash-2-Db9KMxbd.js";import"./supabase-vendor-CqT5vMLU.js";import"./utils-vendor-BTGVH9Kg.js";const re=()=>{var p;const[v,m]=c.useState([]),[h,j]=c.useState(!0),[d,y]=c.useState(""),[o,n]=c.useState({open:!1,recipe:null});c.useEffect(()=>{N()},[]);const N=async()=>{try{j(!0);const{data:s,error:a}=await f.getAllForAdmin(50,0);if(a)throw a;m(s||[])}catch(s){console.error("Error fetching recipes:",s)}finally{j(!1)}},C=async s=>{try{const{error:a}=await f.delete(s.id);if(a)throw a;m(r=>r.filter(D=>D.id!==s.id)),n({open:!1,recipe:null})}catch(a){console.error("Error deleting recipe:",a)}},u=v.filter(s=>{var a,r;return s.title.toLowerCase().includes(d.toLowerCase())||((r=(a=s.categories)==null?void 0:a.name)==null?void 0:r.toLowerCase().includes(d.toLowerCase()))}),w=s=>{const a={published:"default",draft:"secondary",archived:"destructive"};return e.jsx(F,{variant:a[s]||"secondary",children:s})},b=s=>{const a={easy:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",hard:"bg-red-100 text-red-800"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a[s]||a.medium}`,children:s==="easy"?"Fácil":s==="medium"?"Médio":"Difícil"})};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gerenciar Receitas"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Administre todas as receitas do sistema"})]}),e.jsx(l,{asChild:!0,children:e.jsxs(x,{to:"/admin/recipes/new",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Nova Receita"]})})]}),e.jsxs(z,{children:[e.jsx(_,{children:e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(S,{placeholder:"Buscar receitas...",value:d,onChange:s=>y(s.target.value),className:"pl-10"})]})})}),e.jsxs(H,{children:[h?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs(P,{children:[e.jsx($,{children:e.jsxs(g,{children:[e.jsx(t,{children:"Receita"}),e.jsx(t,{children:"Categoria"}),e.jsx(t,{children:"Dificuldade"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Autor"}),e.jsx(t,{children:"Criado em"}),e.jsx(t,{className:"text-right",children:"Ações"})]})}),e.jsx(q,{children:u.map(s=>{var a,r;return e.jsxs(g,{children:[e.jsx(i,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:s.image_url||"/placeholder-recipe.jpg",alt:s.title,className:"w-10 h-10 rounded-lg object-cover"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.title}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.prep_time+s.cook_time," min"]})]})]})}),e.jsx(i,{children:((a=s.categories)==null?void 0:a.name)||"Sem categoria"}),e.jsx(i,{children:b(s.difficulty)}),e.jsx(i,{children:w(s.status)}),e.jsx(i,{children:((r=s.profiles)==null?void 0:r.full_name)||"Autor desconhecido"}),e.jsx(i,{children:new Date(s.created_at).toLocaleDateString("pt-BR")}),e.jsx(i,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(l,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(x,{to:`/recipes/${s.slug}`,children:e.jsx(T,{className:"h-4 w-4"})})}),e.jsx(l,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(x,{to:`/admin/recipes/${s.id}/edit`,children:e.jsx(M,{className:"h-4 w-4"})})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>n({open:!0,recipe:s}),className:"text-red-600 hover:text-red-700",children:e.jsx(O,{className:"h-4 w-4"})})]})})]},s.id)})})]}),!h&&u.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhuma receita encontrada"})})]})]}),e.jsx(R,{open:o.open,onOpenChange:s=>n({open:s,recipe:null}),children:e.jsxs(E,{children:[e.jsxs(L,{children:[e.jsx(B,{children:"Confirmar Exclusão"}),e.jsxs(A,{children:['Tem certeza que deseja excluir a receita "',(p=o.recipe)==null?void 0:p.title,'"? Esta ação não pode ser desfeita.']})]}),e.jsxs(k,{children:[e.jsx(l,{variant:"outline",onClick:()=>n({open:!1,recipe:null}),children:"Cancelar"}),e.jsx(l,{variant:"destructive",onClick:()=>C(o.recipe),children:"Excluir"})]})]})})]})};export{re as RecipesAdmin};
