import{j as e}from"./ui-vendor-CCxVMQ9B.js";import{r as n,L as c}from"./react-vendor-CN1YoO9o.js";import{d as p,B as l,I as S,E as T,D as L,v as E,w as B,x as z,y as I,z as $}from"./index-DStP_-PY.js";import{C as A,b as k,a as H}from"./card-DDJFiqOK.js";import{B as P}from"./badge-B80lkMBr.js";import{T as R,a as _,b as f,c as t,d as q,e as i}from"./table-CZG2d7nx.js";import{P as F}from"./plus-B7lLGJlf.js";import{S as G}from"./search-DyISHBFt.js";import{U}from"./users-jO4XmtX7.js";import{S as O}from"./square-pen--POmUCjf.js";import{T as J}from"./trash-2-Db9KMxbd.js";import"./supabase-vendor-CqT5vMLU.js";import"./utils-vendor-BTGVH9Kg.js";const ie=()=>{var g;const[v,h]=n.useState([]),[m,j]=n.useState(!0),[d,C]=n.useState(""),[x,o]=n.useState({open:!1,course:null});n.useEffect(()=>{N()},[]);const N=async()=>{try{j(!0);const{data:s,error:r}=await p.getAll(50,0);if(r)throw r;h(s||[])}catch(s){console.error("Error fetching courses:",s)}finally{j(!1)}},y=async s=>{try{const{error:r}=await p.delete(s.id);if(r)throw r;h(a=>a.filter(D=>D.id!==s.id)),o({open:!1,course:null})}catch(r){console.error("Error deleting course:",r)}},u=v.filter(s=>{var r,a;return s.title.toLowerCase().includes(d.toLowerCase())||((a=(r=s.categories)==null?void 0:r.name)==null?void 0:a.toLowerCase().includes(d.toLowerCase()))}),b=s=>{const r={published:"default",draft:"secondary",archived:"destructive"};return e.jsx(P,{variant:r[s]||"secondary",children:s})},w=s=>{const r={beginner:"bg-green-100 text-green-800",intermediate:"bg-yellow-100 text-yellow-800",advanced:"bg-red-100 text-red-800"},a={beginner:"Iniciante",intermediate:"Intermediário",advanced:"Avançado"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r[s]||r.beginner}`,children:a[s]||s})};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gerenciar Cursos"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Administre todos os cursos do sistema"})]}),e.jsx(l,{asChild:!0,children:e.jsxs(c,{to:"/admin/courses/new",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Novo Curso"]})})]}),e.jsxs(A,{children:[e.jsx(k,{children:e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(S,{placeholder:"Buscar cursos...",value:d,onChange:s=>C(s.target.value),className:"pl-10"})]})})}),e.jsxs(H,{children:[m?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs(R,{children:[e.jsx(_,{children:e.jsxs(f,{children:[e.jsx(t,{children:"Curso"}),e.jsx(t,{children:"Categoria"}),e.jsx(t,{children:"Nível"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Preço"}),e.jsx(t,{children:"Instrutor"}),e.jsx(t,{children:"Criado em"}),e.jsx(t,{className:"text-right",children:"Ações"})]})}),e.jsx(q,{children:u.map(s=>{var r,a;return e.jsxs(f,{children:[e.jsx(i,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:s.image_url||"/placeholder-course.jpg",alt:s.title,className:"w-10 h-10 rounded-lg object-cover"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.title}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.duration_hours,"h de conteúdo"]})]})]})}),e.jsx(i,{children:((r=s.categories)==null?void 0:r.name)||"Sem categoria"}),e.jsx(i,{children:w(s.level)}),e.jsx(i,{children:b(s.status)}),e.jsx(i,{children:s.price>0?`R$ ${s.price.toFixed(2)}`:"Gratuito"}),e.jsx(i,{children:((a=s.profiles)==null?void 0:a.full_name)||"Instrutor desconhecido"}),e.jsx(i,{children:new Date(s.created_at).toLocaleDateString("pt-BR")}),e.jsx(i,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(l,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(c,{to:`/courses/${s.slug}`,children:e.jsx(T,{className:"h-4 w-4"})})}),e.jsx(l,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(c,{to:`/admin/courses/${s.id}/students`,children:e.jsx(U,{className:"h-4 w-4"})})}),e.jsx(l,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(c,{to:`/admin/courses/${s.id}/edit`,children:e.jsx(O,{className:"h-4 w-4"})})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>o({open:!0,course:s}),className:"text-red-600 hover:text-red-700",children:e.jsx(J,{className:"h-4 w-4"})})]})})]},s.id)})})]}),!m&&u.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhum curso encontrado"})})]})]}),e.jsx(L,{open:x.open,onOpenChange:s=>o({open:s,course:null}),children:e.jsxs(E,{children:[e.jsxs(B,{children:[e.jsx(z,{children:"Confirmar Exclusão"}),e.jsxs(I,{children:['Tem certeza que deseja excluir o curso "',(g=x.course)==null?void 0:g.title,'"? Esta ação não pode ser desfeita e afetará todos os alunos matriculados.']})]}),e.jsxs($,{children:[e.jsx(l,{variant:"outline",onClick:()=>o({open:!1,course:null}),children:"Cancelar"}),e.jsx(l,{variant:"destructive",onClick:()=>y(x.course),children:"Excluir"})]})]})})]})};export{ie as CoursesAdmin};
