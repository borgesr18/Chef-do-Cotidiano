import{j as e}from"./ui-vendor-CCxVMQ9B.js";import{r as l,L as z}from"./react-vendor-CN1YoO9o.js";import{C as A,b as k,c as B,a as R}from"./card-DDJFiqOK.js";import{s as m,d as O,B as j,I as F,a as C,u as v}from"./index-DStP_-PY.js";import{B as N}from"./badge-B80lkMBr.js";import{S as b,a as _,b as S,c as E,d as x}from"./select-atrVVbAC.js";import{u as M}from"./useCategories-7MF5cVH2.js";import{S as V}from"./SEO-BV2VGWhT.js";import{L as D}from"./LazyImage-BTHAI7S6.js";import{P as $}from"./play-Cm0wmEFS.js";import{S as q}from"./star-BCJjEaYq.js";import{C as G}from"./clock-Wc9Bu7ld.js";import{U as H}from"./users-jO4XmtX7.js";import"./supabase-vendor-CqT5vMLU.js";import"./utils-vendor-BTGVH9Kg.js";const J=()=>{const[p,r]=l.useState(!1),[f,o]=l.useState(null);return{loading:p,error:f,createEnrollment:async t=>{try{r(!0),o(null);const{data:{user:a}}=await m.auth.getUser();if(!a)throw new Error("User not authenticated");const{data:n,error:h}=await m.from("course_enrollments").insert([{user_id:a.id,course_id:t}]).select().single();if(h)throw h;return{data:n,error:null}}catch(a){return o(a.message),{data:null,error:a.message}}finally{r(!1)}},updatePaymentStatus:async t=>{try{r(!0),o(null);const{data:a,error:n}=await m.from("course_enrollments").update({updated_at:new Date().toISOString()}).eq("id",t).select().single();if(n)throw n;return{data:a,error:null}}catch(a){return o(a.message),{data:null,error:a.message}}finally{r(!1)}},getUserEnrollments:async()=>{try{r(!0),o(null);const{data:{user:t}}=await m.auth.getUser();if(!t)throw new Error("User not authenticated");const{data:a,error:n}=await m.from("course_enrollments").select(`
          *,
          courses(title, slug, featured_image, price)
        `).eq("user_id",t.id).order("enrolled_at",{ascending:!1});if(n)throw n;return{data:a,error:null}}catch(t){return o(t.message),{data:null,error:t.message}}finally{r(!1)}}}},ce=()=>{const[p,r]=l.useState([]),[f,o]=l.useState(!0),[u,w]=l.useState(""),[c,t]=l.useState(""),[a,n]=l.useState(""),{categories:h}=M(),{createEnrollment:L}=J(),y=[{id:1,title:"Churrasco Perfeito",description:"Aprenda todas as técnicas para fazer o churrasco perfeito, desde a escolha da carne até o ponto ideal.",featured_image:"https://images.unsplash.com/photo-1529193591184-b1d58069ecdd?w=400&h=300&fit=crop",price:149.9,level:"Intermediário",duration_hours:8,lessons_count:12,students_count:245,rating:4.8,instructor_name:"Chef Rodrigo",category_name:"Carnes",status:"published"},{id:2,title:"Massas Artesanais",description:"Domine a arte de fazer massas frescas em casa, desde o básico até receitas mais elaboradas.",featured_image:"https://images.unsplash.com/photo-1621996346565-e3dbc353d2e5?w=400&h=300&fit=crop",price:99.9,level:"Iniciante",duration_hours:6,lessons_count:10,students_count:189,rating:4.7,instructor_name:"Chef Rodrigo",category_name:"Massas",status:"published"},{id:3,title:"Frutos do Mar Gourmet",description:"Técnicas profissionais para preparar pratos sofisticados com frutos do mar.",featured_image:"https://images.unsplash.com/photo-1467003909585-2f8a72700288?w=400&h=300&fit=crop",price:199.9,level:"Avançado",duration_hours:10,lessons_count:15,students_count:156,rating:4.9,instructor_name:"Chef Rodrigo",category_name:"Frutos do Mar",status:"published"}];l.useEffect(()=>{I()},[]);const I=async()=>{try{o(!0);const{data:s,error:i}=await O.getPublished();i||!s||s.length===0?r(y):r(s)}catch{r(y)}finally{o(!1)}},T=async(s,i)=>{try{(await L(s,{method:"stripe",amount:i,transactionId:`temp_${Date.now()}`})).data?v.success("Inscrição realizada com sucesso!"):v.error("Erro ao processar inscrição")}catch{v.error("Erro ao processar inscrição")}},d=p.filter(s=>{const i=s.title.toLowerCase().includes(u.toLowerCase())||s.description.toLowerCase().includes(u.toLowerCase()),g=!c||c==="all"||s.category_name===c,U=!a||a==="all"||s.level===a;return i&&g&&U}),P=["Iniciante","Intermediário","Avançado"];return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(V,{title:"Cursos Online - Chef do Cotidiano",description:"Aprenda a cozinhar com nossos cursos online. Técnicas profissionais, receitas exclusivas e acompanhamento personalizado.",image:"https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=1200&h=630&fit=crop"}),e.jsx("section",{className:"bg-gradient-to-r from-primary to-primary/80 text-primary-foreground py-16",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Cursos Online de Culinária"}),e.jsx("p",{className:"text-xl mb-8 max-w-2xl mx-auto",children:"Aprenda técnicas profissionais de culinária com o Chef Rodrigo. Cursos práticos e didáticos para todos os níveis."}),e.jsxs(j,{size:"lg",variant:"secondary",children:[e.jsx($,{className:"h-5 w-5 mr-2"}),"Começar Agora"]})]})}),e.jsx("section",{className:"py-8 border-b",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center",children:[e.jsx("div",{className:"flex-1",children:e.jsx(F,{placeholder:"Buscar cursos...",value:u,onChange:s=>w(s.target.value),className:"max-w-md"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(b,{value:c,onValueChange:t,children:[e.jsx(_,{className:"w-48",children:e.jsx(S,{placeholder:"Todas as categorias"})}),e.jsxs(E,{children:[e.jsx(x,{value:"all",children:"Todas as categorias"}),h.map(s=>e.jsx(x,{value:s.name,children:s.name},s.id))]})]}),e.jsxs(b,{value:a,onValueChange:n,children:[e.jsx(_,{className:"w-48",children:e.jsx(S,{placeholder:"Todos os níveis"})}),e.jsxs(E,{children:[e.jsx(x,{value:"all",children:"Todos os níveis"}),P.map(s=>e.jsx(x,{value:s,children:s},s))]})]})]})]})})}),e.jsx("section",{className:"py-12",children:e.jsx("div",{className:"container mx-auto px-4",children:f?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{role:"status","aria-label":"Carregando",className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:e.jsxs("h2",{className:"text-2xl font-bold",children:[d.length," curso",d.length!==1?"s":""," encontrado",d.length!==1?"s":""]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:d.map(s=>{var i;return e.jsxs(A,{className:"overflow-hidden hover:shadow-xl transition-shadow group cursor-pointer",children:[e.jsxs("div",{className:"relative",children:[e.jsx(D,{src:s.featured_image,alt:s.title,className:"w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx(N,{variant:"secondary",children:s.category_name})}),e.jsx("div",{className:"absolute bottom-4 left-4",children:e.jsxs(N,{className:"bg-green-600 text-white",children:["R$ ",(i=s.price)==null?void 0:i.toFixed(2)]})})]}),e.jsxs(k,{children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx(B,{className:"text-xl group-hover:text-primary transition-colors",children:s.title}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(q,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"text-sm font-medium",children:s.rating})]})]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:s.description})]}),e.jsx(R,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.duration_hours,"h"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.lessons_count," aulas"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{children:s.students_count})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx(N,{variant:"outline",children:s.level})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["por ",s.instructor_name]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{className:"flex-1",asChild:!0,children:e.jsx(z,{to:`/courses/${s.id}`,children:"Ver Curso"})}),e.jsx(j,{variant:"outline",onClick:()=>T(s.id,s.price),children:"Inscrever-se"})]})]})})]},s.id)})}),d.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(C,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Nenhum curso encontrado"}),e.jsx("p",{className:"text-muted-foreground",children:"Tente ajustar os filtros ou buscar por outros termos."})]})]})})})]})};export{ce as CoursesPage,ce as default};
