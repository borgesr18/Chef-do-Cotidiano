import{j as e}from"./ui-vendor-CCxVMQ9B.js";import{r as o,L as x}from"./react-vendor-CN1YoO9o.js";import{e as p,B as i,I as D,E as S,D as T,v as B,w as L,x as P,y as E,z as A}from"./index-DStP_-PY.js";import{C as z,b as _,a as k}from"./card-DDJFiqOK.js";import{B as H}from"./badge-B80lkMBr.js";import{T as R,a as q,b as f,c as t,d as I,e as l}from"./table-CZG2d7nx.js";import{P as $}from"./plus-B7lLGJlf.js";import{S as F}from"./search-DyISHBFt.js";import{S as G}from"./square-pen--POmUCjf.js";import{T as O}from"./trash-2-Db9KMxbd.js";import"./supabase-vendor-CqT5vMLU.js";import"./utils-vendor-BTGVH9Kg.js";const ae=()=>{var g;const[v,h]=o.useState([]),[m,j]=o.useState(!0),[c,b]=o.useState(""),[d,n]=o.useState({open:!1,post:null});o.useEffect(()=>{N()},[]);const N=async()=>{try{j(!0);const{data:s,error:a}=await p.getAll(50,0);if(a)throw a;h(s||[])}catch(s){console.error("Error fetching blog posts:",s)}finally{j(!1)}},C=async s=>{try{const{error:a}=await p.delete(s.id);if(a)throw a;h(r=>r.filter(y=>y.id!==s.id)),n({open:!1,post:null})}catch(a){console.error("Error deleting blog post:",a)}},u=v.filter(s=>{var a,r;return s.title.toLowerCase().includes(c.toLowerCase())||((r=(a=s.categories)==null?void 0:a.name)==null?void 0:r.toLowerCase().includes(c.toLowerCase()))}),w=s=>{const a={published:"default",draft:"secondary",archived:"destructive"};return e.jsx(H,{variant:a[s]||"secondary",children:s})};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gerenciar Blog"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Administre todos os posts do blog"})]}),e.jsx(i,{asChild:!0,children:e.jsxs(x,{to:"/admin/blog/new",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Novo Post"]})})]}),e.jsxs(z,{children:[e.jsx(_,{children:e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(F,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(D,{placeholder:"Buscar posts...",value:c,onChange:s=>b(s.target.value),className:"pl-10"})]})})}),e.jsxs(k,{children:[m?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs(R,{children:[e.jsx(q,{children:e.jsxs(f,{children:[e.jsx(t,{children:"Post"}),e.jsx(t,{children:"Categoria"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Autor"}),e.jsx(t,{children:"Criado em"}),e.jsx(t,{children:"Publicado em"}),e.jsx(t,{className:"text-right",children:"Ações"})]})}),e.jsx(I,{children:u.map(s=>{var a,r;return e.jsxs(f,{children:[e.jsx(l,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:s.featured_image||"/placeholder-blog.jpg",alt:s.title,className:"w-10 h-10 rounded-lg object-cover"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.title}),e.jsx("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:s.excerpt||"Sem resumo"})]})]})}),e.jsx(l,{children:((a=s.categories)==null?void 0:a.name)||"Sem categoria"}),e.jsx(l,{children:w(s.status)}),e.jsx(l,{children:((r=s.profiles)==null?void 0:r.full_name)||"Autor desconhecido"}),e.jsx(l,{children:new Date(s.created_at).toLocaleDateString("pt-BR")}),e.jsx(l,{children:s.published_at?new Date(s.published_at).toLocaleDateString("pt-BR"):"-"}),e.jsx(l,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(i,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(x,{to:`/blog/${s.slug}`,children:e.jsx(S,{className:"h-4 w-4"})})}),e.jsx(i,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(x,{to:`/admin/blog/${s.id}/edit`,children:e.jsx(G,{className:"h-4 w-4"})})}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>n({open:!0,post:s}),className:"text-red-600 hover:text-red-700",children:e.jsx(O,{className:"h-4 w-4"})})]})})]},s.id)})})]}),!m&&u.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhum post encontrado"})})]})]}),e.jsx(T,{open:d.open,onOpenChange:s=>n({open:s,post:null}),children:e.jsxs(B,{children:[e.jsxs(L,{children:[e.jsx(P,{children:"Confirmar Exclusão"}),e.jsxs(E,{children:['Tem certeza que deseja excluir o post "',(g=d.post)==null?void 0:g.title,'"? Esta ação não pode ser desfeita.']})]}),e.jsxs(A,{children:[e.jsx(i,{variant:"outline",onClick:()=>n({open:!1,post:null}),children:"Cancelar"}),e.jsx(i,{variant:"destructive",onClick:()=>C(d.post),children:"Excluir"})]})]})})]})};export{ae as BlogAdmin};
