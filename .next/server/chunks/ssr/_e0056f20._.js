module.exports=[1198,a=>{"use strict";a.s(["GripVertical",()=>b],1198);let b=(0,a.i(45806).default)("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]])},54143,a=>{"use strict";a.s(["DragDropProvider",()=>f,"useDragDrop",()=>e]);var b=a.i(8171),c=a.i(27669);let d=(0,c.createContext)({}),e=()=>{let a=(0,c.useContext)(d);if(!a)throw Error("useDragDrop must be used within a DragDropProvider");return a},f=({children:a})=>{let[e,f]=(0,c.useState)(null),[g,h]=(0,c.useState)(null),i=()=>{f(null),h(null)};return(0,b.jsx)(d.Provider,{value:{draggedItem:e,dropTarget:g,setDropTarget:h,handleDragStart:(a,b)=>{f({...a,type:b})},handleDragEnd:i,handleDragOver:a=>{a.preventDefault()},handleDrop:(a,b)=>{e&&a&&e.id!==a.id&&b(e,a),i()}},children:a})}},52408,a=>{"use strict";a.s(["DraggableItem",()=>e]);var b=a.i(8171),c=a.i(54143),d=a.i(1198);let e=({item:a,type:e,children:f,onReorder:g,className:h=""})=>{let{handleDragStart:i,handleDragEnd:j,handleDragOver:k,handleDrop:l}=(0,c.useDragDrop)();return(0,b.jsx)("div",{draggable:!0,onDragStart:()=>i(a,e),onDragEnd:j,onDragOver:k,onDrop:()=>l(a,g),className:`cursor-move ${h}`,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.GripVertical,{className:"h-4 w-4 text-gray-400 flex-shrink-0"}),(0,b.jsx)("div",{className:"flex-1",children:f})]})})}},92843,a=>a.a(async(b,c)=>{try{a.s(["CourseForm",()=>y]);var d=a.i(8171),e=a.i(27669),f=a.i(58104),g=a.i(91404),h=a.i(89202),i=a.i(52569),j=a.i(73996),k=a.i(12971),l=a.i(45458),m=a.i(77691),n=a.i(52585),o=a.i(29830),p=a.i(99856),q=a.i(42025),r=a.i(71067),s=a.i(1198),t=a.i(31321),u=a.i(54143),v=a.i(52408),w=a.i(23414),x=b([g,h,i,j,k,l,m,p,w]);[g,h,i,j,k,l,m,p,w]=x.then?(await x)():x;let y=()=>{let a=(0,f.useNavigate)(),{id:b}=(0,f.useParams)(),c=!!b,[x,y]=(0,e.useState)(!1),[z,A]=(0,e.useState)([]),[B,C]=(0,e.useState)({title:"",slug:"",description:"",level:"beginner",status:"draft",price:"",category_id:"",featured_image:"",what_you_learn:[""],target_audience:"",modules:[]});(0,e.useEffect)(()=>{D(),c&&E()},[b]);let D=async()=>{try{let{data:a}=await o.categories.getAll();A(a||[])}catch(a){}},E=async()=>{try{y(!0);let{data:a,error:c}=await o.courses.getById(b);if(c)throw c;a&&C({title:a.title||"",slug:a.slug||"",description:a.description||"",level:a.level||"beginner",status:a.status||"draft",price:a.price?.toString()||"",category_id:a.category_id||"",featured_image:a.featured_image||"",what_you_learn:a.what_you_learn||[""],target_audience:a.target_audience||"",modules:a.modules||[]})}catch(a){}finally{y(!1)}},F=(a,b)=>{C(c=>({...c,[a]:b})),"title"!==a||c||C(a=>({...a,slug:(0,p.generateSlug)(b)}))},G=(a,b,c)=>{let d=[...B.modules];d[a]={...d[a],[b]:c},C(a=>({...a,modules:d}))},H=(a,b,c,d)=>{let e=[...B.modules];e[a].lessons[b]={...e[a].lessons[b],[c]:d},C(a=>({...a,modules:e}))},I=(a,b)=>{let c=[...B.modules],d=c.findIndex(b=>b.id===a.id),e=c.findIndex(a=>a.id===b.id),[f]=c.splice(d,1);c.splice(e,0,f),c.forEach((a,b)=>{a.sort_order=b}),C(a=>({...a,modules:c}))},J=async a=>{let b=a.target.files[0];if(b)try{y(!0);let a=b.name.split(".").pop(),c=`${Date.now()}.${a}`,d=`courses/${c}`,{error:e}=await n.supabase.storage.from("images").upload(d,b);if(e)throw e;let{data:{publicUrl:f}}=n.supabase.storage.from("images").getPublicUrl(d);C(a=>({...a,featured_image:f}))}catch(a){}finally{y(!1)}},K=async d=>{d.preventDefault();try{let d;y(!0);let e={...B,price:parseFloat(B.price)||0};if((d=c?await o.courses.update(b,e):await o.courses.create(e)).error)throw d.error;w.toast.success(c?"Curso atualizado com sucesso!":"Curso criado com sucesso!"),a("/admin/courses")}catch(a){w.toast.error("Erro ao salvar curso")}finally{y(!1)}};return x&&c?(0,d.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,d.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):(0,d.jsxs)("div",{className:"p-6 max-w-6xl mx-auto",children:[(0,d.jsxs)("div",{className:"flex items-center mb-6",children:[(0,d.jsxs)(g.Button,{variant:"ghost",onClick:()=>a("/admin/courses"),className:"mr-4",children:[(0,d.jsx)(t.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Voltar"]}),(0,d.jsx)("h1",{className:"text-3xl font-bold",children:c?"Editar Curso":"Novo Curso"})]}),(0,d.jsx)(u.DragDropProvider,{children:(0,d.jsxs)("form",{onSubmit:K,className:"space-y-6",children:[(0,d.jsxs)(h.Card,{children:[(0,d.jsx)(h.CardHeader,{children:(0,d.jsx)(h.CardTitle,{children:"Informações Básicas"})}),(0,d.jsxs)(h.CardContent,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(j.Label,{htmlFor:"title",children:"Título *"}),(0,d.jsx)(i.Input,{id:"title",value:B.title,onChange:a=>F("title",a.target.value),required:!0})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(j.Label,{htmlFor:"slug",children:"Slug"}),(0,d.jsx)(i.Input,{id:"slug",value:B.slug,onChange:a=>F("slug",a.target.value)})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(j.Label,{htmlFor:"description",children:"Descrição *"}),(0,d.jsx)(k.Textarea,{id:"description",value:B.description,onChange:a=>F("description",a.target.value),rows:3,required:!0})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(j.Label,{htmlFor:"level",children:"Nível"}),(0,d.jsxs)(l.Select,{value:B.level,onValueChange:a=>F("level",a),children:[(0,d.jsx)(l.SelectTrigger,{children:(0,d.jsx)(l.SelectValue,{})}),(0,d.jsxs)(l.SelectContent,{children:[(0,d.jsx)(l.SelectItem,{value:"beginner",children:"Iniciante"}),(0,d.jsx)(l.SelectItem,{value:"intermediate",children:"Intermediário"}),(0,d.jsx)(l.SelectItem,{value:"advanced",children:"Avançado"})]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(j.Label,{htmlFor:"price",children:"Preço (R$)"}),(0,d.jsx)(i.Input,{id:"price",type:"number",step:"0.01",value:B.price,onChange:a=>F("price",a.target.value),placeholder:"0.00"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(j.Label,{htmlFor:"category",children:"Categoria"}),(0,d.jsxs)(l.Select,{value:B.category_id,onValueChange:a=>F("category_id",a),children:[(0,d.jsx)(l.SelectTrigger,{children:(0,d.jsx)(l.SelectValue,{placeholder:"Selecione uma categoria"})}),(0,d.jsx)(l.SelectContent,{children:z.map(a=>(0,d.jsx)(l.SelectItem,{value:a.id,children:a.name},a.id))})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(j.Label,{htmlFor:"status",children:"Status"}),(0,d.jsxs)(l.Select,{value:B.status,onValueChange:a=>F("status",a),children:[(0,d.jsx)(l.SelectTrigger,{children:(0,d.jsx)(l.SelectValue,{})}),(0,d.jsxs)(l.SelectContent,{children:[(0,d.jsx)(l.SelectItem,{value:"draft",children:"Rascunho"}),(0,d.jsx)(l.SelectItem,{value:"published",children:"Publicado"}),(0,d.jsx)(l.SelectItem,{value:"archived",children:"Arquivado"})]})]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(j.Label,{htmlFor:"target_audience",children:"Público-alvo"}),(0,d.jsx)(k.Textarea,{id:"target_audience",value:B.target_audience,onChange:a=>F("target_audience",a.target.value),rows:2,placeholder:"Para quem é este curso?"})]})]})]}),(0,d.jsxs)(h.Card,{children:[(0,d.jsx)(h.CardHeader,{children:(0,d.jsx)(h.CardTitle,{children:"Imagem em Destaque"})}),(0,d.jsx)(h.CardContent,{children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(j.Label,{htmlFor:"image-upload",children:"Upload de Imagem"}),(0,d.jsx)(i.Input,{id:"image-upload",type:"file",accept:"image/*",onChange:J,className:"cursor-pointer"})]}),B.featured_image&&(0,d.jsx)("div",{children:(0,d.jsx)("img",{src:B.featured_image,alt:"Preview",className:"w-32 h-32 object-cover rounded-lg"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)(j.Label,{htmlFor:"image-url",children:"URL da Imagem"}),(0,d.jsx)(i.Input,{id:"image-url",value:B.featured_image,onChange:a=>F("featured_image",a.target.value),placeholder:"https://exemplo.com/imagem.jpg"})]})]})})]}),(0,d.jsxs)(h.Card,{children:[(0,d.jsx)(h.CardHeader,{children:(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)(h.CardTitle,{children:"O que você vai aprender"}),(0,d.jsxs)(g.Button,{type:"button",onClick:()=>{C(a=>({...a,what_you_learn:[...a.what_you_learn,""]}))},size:"sm",children:[(0,d.jsx)(q.Plus,{className:"h-4 w-4 mr-2"}),"Adicionar"]})]})}),(0,d.jsx)(h.CardContent,{children:(0,d.jsx)("div",{className:"space-y-3",children:B.what_you_learn.map((a,b)=>(0,d.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,d.jsx)(i.Input,{value:a,onChange:a=>((a,b)=>{let c=[...B.what_you_learn];c[a]=b,C(a=>({...a,what_you_learn:c}))})(b,a.target.value),placeholder:"Ex: Técnicas básicas de corte",className:"flex-1"}),(0,d.jsx)(g.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>{B.what_you_learn.length>1&&C(a=>({...a,what_you_learn:a.what_you_learn.filter((a,c)=>c!==b)}))},disabled:1===B.what_you_learn.length,children:(0,d.jsx)(r.Trash2,{className:"h-4 w-4"})})]},b))})})]}),(0,d.jsxs)(h.Card,{children:[(0,d.jsx)(h.CardHeader,{children:(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)(h.CardTitle,{children:"Módulos do Curso"}),(0,d.jsxs)(g.Button,{type:"button",onClick:()=>{let a={id:Date.now(),title:"",description:"",sort_order:B.modules.length,lessons:[]};C(b=>({...b,modules:[...b.modules,a]}))},size:"sm",children:[(0,d.jsx)(q.Plus,{className:"h-4 w-4 mr-2"}),"Adicionar Módulo"]})]})}),(0,d.jsx)(h.CardContent,{children:(0,d.jsx)("div",{className:"space-y-6",children:B.modules.map((a,b)=>(0,d.jsx)(v.DraggableItem,{item:a,type:"module",onReorder:I,children:(0,d.jsxs)(h.Card,{className:"border-l-4 border-l-primary",children:[(0,d.jsx)(h.CardHeader,{className:"pb-3",children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(s.GripVertical,{className:"h-4 w-4 text-gray-400"}),(0,d.jsxs)(m.Badge,{variant:"outline",children:["Módulo ",b+1]})]}),(0,d.jsx)(g.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>{C(a=>({...a,modules:a.modules.filter((a,c)=>c!==b)}))},children:(0,d.jsx)(r.Trash2,{className:"h-4 w-4"})})]})}),(0,d.jsxs)(h.CardContent,{className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(j.Label,{children:"Título do Módulo"}),(0,d.jsx)(i.Input,{value:a.title,onChange:a=>G(b,"title",a.target.value),placeholder:"Ex: Fundamentos da Culinária"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(j.Label,{children:"Descrição"}),(0,d.jsx)(k.Textarea,{value:a.description,onChange:a=>G(b,"description",a.target.value),rows:2,placeholder:"Descrição do módulo..."})]}),(0,d.jsxs)("div",{className:"border-t pt-4",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,d.jsx)("h4",{className:"font-medium",children:"Aulas"}),(0,d.jsxs)(g.Button,{type:"button",onClick:()=>(a=>{let b={id:Date.now(),title:"",description:"",video_url:"",duration_minutes:"",is_preview:!1,sort_order:B.modules[a].lessons.length},c=[...B.modules];c[a].lessons.push(b),C(a=>({...a,modules:c}))})(b),size:"sm",variant:"outline",children:[(0,d.jsx)(q.Plus,{className:"h-4 w-4 mr-2"}),"Adicionar Aula"]})]}),(0,d.jsx)("div",{className:"space-y-3",children:a.lessons.map((a,c)=>(0,d.jsx)(v.DraggableItem,{item:a,type:"lesson",onReorder:(a,c)=>((a,b,c)=>{let d=[...B.modules],e=d[a].lessons,f=e.findIndex(a=>a.id===b.id),g=e.findIndex(a=>a.id===c.id),[h]=e.splice(f,1);e.splice(g,0,h),e.forEach((a,b)=>{a.sort_order=b}),C(a=>({...a,modules:d}))})(b,a,c),children:(0,d.jsxs)("div",{className:"border rounded-lg p-3 bg-gray-50",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsxs)(m.Badge,{variant:"secondary",size:"sm",children:["Aula ",c+1]}),(0,d.jsx)(g.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>((a,b)=>{let c=[...B.modules];c[a].lessons=c[a].lessons.filter((a,c)=>c!==b),C(a=>({...a,modules:c}))})(b,c),children:(0,d.jsx)(r.Trash2,{className:"h-4 w-4"})})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(j.Label,{children:"Título da Aula"}),(0,d.jsx)(i.Input,{value:a.title,onChange:a=>H(b,c,"title",a.target.value),placeholder:"Título da aula",size:"sm"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(j.Label,{children:"Duração (min)"}),(0,d.jsx)(i.Input,{type:"number",value:a.duration_minutes,onChange:a=>H(b,c,"duration_minutes",a.target.value),placeholder:"30",size:"sm"})]})]}),(0,d.jsxs)("div",{className:"mt-2",children:[(0,d.jsx)(j.Label,{children:"URL do Vídeo"}),(0,d.jsx)(i.Input,{value:a.video_url,onChange:a=>H(b,c,"video_url",a.target.value),placeholder:"https://youtube.com/watch?v=...",size:"sm"})]}),(0,d.jsxs)("div",{className:"mt-2",children:[(0,d.jsx)(j.Label,{children:"Descrição"}),(0,d.jsx)(k.Textarea,{value:a.description,onChange:a=>H(b,c,"description",a.target.value),rows:2,placeholder:"Descrição da aula..."})]}),(0,d.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[(0,d.jsx)("input",{type:"checkbox",id:`preview-${b}-${c}`,checked:a.is_preview,onChange:a=>H(b,c,"is_preview",a.target.checked)}),(0,d.jsx)(j.Label,{htmlFor:`preview-${b}-${c}`,children:"Aula gratuita (preview)"})]})]})},a.id))})]})]})]})},a.id))})})]}),(0,d.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,d.jsx)(g.Button,{type:"button",variant:"outline",onClick:()=>a("/admin/courses"),children:"Cancelar"}),(0,d.jsxs)(g.Button,{type:"submit",disabled:x,children:[x?"Salvando...":c?"Atualizar":"Criar"," Curso"]})]})]})})]})};c()}catch(a){c(a)}},!1),75841,a=>a.a(async(b,c)=>{try{a.s(["config",()=>p,"default",()=>l,"getServerSideProps",()=>o,"getStaticPaths",()=>n,"getStaticProps",()=>m,"handler",()=>x,"reportWebVitals",()=>q,"routeModule",()=>w,"unstable_getServerProps",()=>u,"unstable_getServerSideProps",()=>v,"unstable_getStaticParams",()=>t,"unstable_getStaticPaths",()=>s,"unstable_getStaticProps",()=>r]);var d=a.i(54120),e=a.i(76177),f=a.i(49384),g=a.i(36062),h=a.i(95559),i=a.i(92843),j=a.i(62165),k=b([i]);[i]=k.then?(await k)():k;let l=(0,f.hoist)(i,"default"),m=(0,f.hoist)(i,"getStaticProps"),n=(0,f.hoist)(i,"getStaticPaths"),o=(0,f.hoist)(i,"getServerSideProps"),p=(0,f.hoist)(i,"config"),q=(0,f.hoist)(i,"reportWebVitals"),r=(0,f.hoist)(i,"unstable_getStaticProps"),s=(0,f.hoist)(i,"unstable_getStaticPaths"),t=(0,f.hoist)(i,"unstable_getStaticParams"),u=(0,f.hoist)(i,"unstable_getServerProps"),v=(0,f.hoist)(i,"unstable_getServerSideProps"),w=new d.PagesRouteModule({definition:{kind:e.RouteKind.PAGES,page:"/admin/CourseForm",pathname:"/admin/CourseForm",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:h.default,Document:g.default},userland:i}),x=(0,j.getHandler)({srcPage:"/admin/CourseForm",config:p,userland:i,routeModule:w,getStaticPaths:n,getStaticProps:m,getServerSideProps:o});c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=_e0056f20._.js.map